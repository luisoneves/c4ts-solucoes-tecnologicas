---
import { getGlobalSettings, getServices, getStrapiMediaUrl } from '../lib/strapi';

const settings = await getGlobalSettings();
const services = await getServices();

const tituloSecao = settings?.titulo_secao_servicos || "Nossos Serviços";

// --- NOSSO FALLBACK INTELIGENTE ---
const fallbackServices = [
  { id: 1, titulo: "Desenvolvimento Web", descricao: "Sites rápidos, modernos e responsivos.", imagemUrl: "https://picsum.photos/seed/1/400/300" },
  { id: 2, titulo: "Design UX/UI", descricao: "Interfaces funcionais centradas no usuário.", imagemUrl: "https://picsum.photos/seed/2/400/300" },
  { id: 3, titulo: "Automação e APIs", descricao: "Sistemas que economizam tempo e reduzem custos.", imagemUrl: "https://picsum.photos/seed/3/400/300" },
];

const displayServices = services.length > 0 ? services.map(s => ({
    ...s,
    imagemUrl: getStrapiMediaUrl(s.imagem)
})) : fallbackServices;
---

<section id="servicos" class="text-center py-16">
  <h2 class="text-3xl font-semibold mb-10">{tituloSecao}</h2>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-6xl mx-auto px-4">
    {displayServices.map(servico => (
      <div class="bg-white p-6 rounded-lg shadow hover:shadow-lg transition">
        <img src={servico.imagemUrl} alt={`Imagem para ${servico.titulo}`} class="rounded-md mb-4 w-full h-48 object-cover" />
        <h3 class="text-xl font-semibold mb-2">{servico.titulo}</h3>
        <p class="text-gray-600">{servico.descricao}</p>
      </div>
    ))}
  </div>
</section>